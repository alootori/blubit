import pandas as pd
from tqdm import tqdm

# ✅ Load dataset
df = pd.read_csv("data.csv")  # Ensure your file has a "text" column

# ✅ Enable tqdm progress bar
tqdm.pandas()

# ✅ Apply function to all text entries
df["model_response"] = df["text"].progress_apply(query_text)

# ✅ Save results
df.to_csv("processed_text.csv", index=False)

# ✅ Display flagged entries
df[df["model_response"].str.contains("Yes", na=False)]
