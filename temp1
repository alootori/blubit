import pandas as pd
import re

# Sample DataFrame
data = {'text': [
    "I want to cancel my subscription.\n\nThe claim process was unclear.\n\nCan you help?",
    "I wish to withdraw my application.\n\nThere is a delay in my claim processing.",
    "Just a general inquiry.\n\nNo actions needed at this time.",
    "Please terminate my account.\n\nMy claim was rejected.\n\nThis is frustrating!"
]}

df = pd.DataFrame(data)

# Function to extract relevant sentences
def extract_relevant_sentences(text):
    # Split text into sentences by newlines, handling multiple consecutive newlines
    sentences = re.split(r'\n+', text.strip())

    # Define keyword sets
    keywords1 = r'cancel|close|terminate|withdraw'
    keywords2 = r'claim'

    # Filter sentences that contain both sets of keywords
    relevant_sentences = [s for s in sentences if re.search(keywords1, s, re.IGNORECASE) and re.search(keywords2, s, re.IGNORECASE)]

    # Join them back as a single string (or keep as a list if needed)
    return "\n".join(relevant_sentences) if relevant_sentences else None

# Apply function to create a new column
df['extracted_sentences'] = df['text'].apply(extract_relevant_sentences)

# Filter rows where relevant sentences were found
filtered_df = df.dropna(subset=['extracted_sentences'])

# Display the results
import ace_tools as tools
tools.display_dataframe_to_user(name="Filtered DataFrame", dataframe=filtered_df)
